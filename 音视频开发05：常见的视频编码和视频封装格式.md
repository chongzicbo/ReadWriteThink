![image-20241203221735065](https://raw.githubusercontent.com/chongzicbo/images/main/picgo/image-20241203221735065.png)

# 一、常见的视频编码方式

视频编码描述了将原始视频转换为压缩数字格式以通过互联网高效交付的过程。以下是一些常见的视频编码方式：

1. H.264/AVC（Advanced Video Coding）
   - **广泛应用的高效编码**：H.264是一种高效且广泛采用的视频压缩技术。它由ITU - T视频编码专家组（VCEG）和ISO/IEC动态图像专家组（MPEG）联合组成的联合视频组（JVT）提出，也被称为MPEG - 4第十部分。H.264最大的优势是具有**很高的数据压缩比率**，在同等图像质量的条件下，H.264的压缩比是MPEG - 2的2倍以上，是MPEG - 4的1.5 - 2倍。例如原始文件大小为88GB，采用MPEG - 2压缩标准压缩后变成3.5GB，压缩比为25∶1，而采用H.264压缩标准压缩后变为879MB，H.264的压缩比达到惊人的102∶1。
   - **低码率优势**：和MPEG - 2、MPEG - 4ASP等压缩技术相比，在相同的图像质量下，H.264压缩数据量只有MPEG - 2的1/8，MPEG - 4的1/3。低码率（Low BitRate）对H.264的高的压缩比起到了重要的作用，这也使得经过H.264压缩的视频数据，在网络传输过程中所需要的带宽更少，也更加经济，大大节省用户的下载时间和数据流量收费。
   - **高质量图像**：它可以提供连续和流畅的高质量图像质量（DVD水平），在具有高压缩比的同时还拥有高质量流畅的图像，并且H.264提供解决不稳定的网络环境中容易出错的必要的工具，如包丢失等容错能力，网络适应性也很强，其文件可以很容易地在不同的网络传输（如互联网、CDMA、GPRS、WCDMA和CDMA2000等）。
2. H.265/HEVC（High Efficiency Video Coding）
   - **H.264的继任者**：H.265是ITU - TVCEG继H.264之后所制定的新的视频编码标准。它围绕着现有的H.264视频编码标准，保留原来的某些技术，同时对一些相关的技术加以改进。新技术使用先进的技术用以改善码流、编码质量、延时和算法复杂度之间的关系，达到最优化设置。
   - **更高的压缩效率**：H.265旨在在有限带宽下传输更高质量的网络视频，仅需原先的一半带宽即可播放相同质量的视频。例如H.264需要2Mbps传输速度的视频，H.265仅需1 - 2Mbps的传输速度即可传送720P（分辨率1280×720）普通高清音视频。这也意味着，智能手机、平板机等移动设备将能够直接在线播放1080p的全高清视频，并且H.265标准也同时支持4K（4096×2160）和8K（8192×4320）超高清视频。
   - **视频画质保障**：虽然H.265的压缩效果甚于H.264，但它引入了Deblocking filter功能，可以尽量将边缘区域平滑化，建立区块之间数据的依赖性，从而提高整体图像质量，不用担心视频画质的缺损。
3. VP9
   - **先进的压缩技术**：VP9是一种比H.264/AVC更先进、更高质量的压缩技术。它是由Google开发的一种开放、免版税的视频编码格式。VP9采用了更高效的压缩算法，能够在保证视频质量的同时进一步减小文件大小，尤其适用于高清和超高清视频的编码，如4K流媒体等场景下有着良好的表现。
   - **高兼容性**：VP9具有较高的兼容性，能够被多种设备和平台支持，这使得它在网络视频传输和播放方面具有广泛的适用性。例如在一些支持WebM格式（以VP8/VP9为视频编码的开放格式）的浏览器和设备上，可以流畅播放VP9编码的视频内容。
4. AV1
   - **开源且潜力巨大**：AV1是最新、最伟大的开源视频编码技术。它由开放媒体联盟（AOMedia）开发，旨在提供比之前的编码标准（如H.264和H.265）更高的压缩效率，以适应不断增长的高清和超高清视频内容传输需求。由于是开源的，吸引了众多开发者和公司的参与，有望在未来的视频编码领域发挥重要作用。
   - **面临的挑战**：不过目前AV1冗长的编码时间会导致高昂的编码成本，这在一定程度上限制了它的大规模商业应用。但随着技术的发展，编码效率有望不断提高，编码时间可能会逐渐缩短。
5. MPEG - 2
   - **早期的重要标准**：MPEG - 2是较早的视频编码标准，在DVD等视频存储介质中广泛应用。例如传统的DVD视频采用的就是MPEG - 2编码格式。它能够提供较好的视频质量，但相比后来的编码标准，其压缩效率较低。
   - **不同应用场景下的特点**：在一些高清视频传输场景下，MPEG - 2需要6Mbps的传输速率来匹配较好的视频质量，而在相同质量下，H.264可能只需要1 - 2Mbps。不过，MPEG - 2在广播电视等领域也有其独特的应用，因为它已经在这些领域的基础设施中得到了广泛的部署。
6. MPEG - 4
   - **网络流媒体适用**：MPEG - 4是网络上常见的一种视频压缩格式，在用于网络流媒体传输方面效果不错。这种编码方式多用于HDTV - Rip上，它把原有的高清视频文件按照比例缩小到一定的尺寸，以减少文件的大小，同时画面效果不差于DVD效果，以此来寻求一个画面效果和文件尺寸的平衡。
   - **编码文件的标识**：采用MPEG - 4压缩的视频文件一般后缀名avi，但与微软的avi格式容易混淆，从后缀名无法直接区分二者，只能通过解码器来识别。相对于高清视频来说，MPEG - 4格式还显得有点不够用，因此它也不是主流的高清视频信号来源。

# 二、常见的视频封装格式

封装格式也叫容器，就是*将已经编码压缩好的视频流、音频流及字幕按照一定的方案放到一个文件中，便于播放软件播放*。一般来说，视频文件的后缀名就是它的封装格式。常见的视频封装格式如下：

1. MP4
   - **广泛的设备支持**：MP4是一种最为常见的媒体容器格式，几乎所有设备、网站和社交媒体平台都支持该格式。它不仅可以存储视频和音频，还可以存储图像和文本。例如在手机、平板电脑、智能电视等设备上，MP4格式的视频都能很好地播放。
   - **良好的性能特点**：MP4具有体积最小、清晰度高、流式传输、强大的兼容性等特点。在现代的视频分发和播放场景中，无论是在线视频平台还是本地播放，MP4格式都占据着重要的地位。其文件结构设计合理，能够在保证视频质量的同时有效地进行数据存储和传输。
2. MKV
   - **多功能的多媒体容器**：MKV是Matroska的一种媒体文件，是一种新的多媒体封装格式。它可将多种不同编码的视频及16条以上不同格式的音频和不同语言的字幕流封装到一个Matroska Media文件当中，因此也称多媒体容器（Multimedia Container）。例如对于一些有多语言需求的视频内容，MKV格式可以方便地将不同语言的音轨和字幕封装在一起，用户可以根据自己的需求选择不同的语言版本进行观看。
   - **先进的功能特性**：具有良好的开放性和跨平台性，是H.264编码最重要的封装格式之一。MKV采用了可变帧率，在回放变化比较慢（比如说静物）时以比较低的FPS来代替，可以节省不少资源；与AVI和TS相比还增加了错误检测以及修复，这无疑提供了纠错和容错性，更适合于网络传输；在字幕方面，还增加了软字幕功能，字幕可以内嵌在封装里，但不会和视频混淆，也可以多字幕随意选择，这样在传输保存时更为方便，并且采用的是流式传输，可以通过时间戳来管理视频以及音频的同步问题，做到即下即看。
3. AVI（Audio Video Interleave）
   - **早期的经典格式**：AVI即音频视频交叉存取格式，1992年初Microsoft公司推出了AVI技术及其应用软件VFW（Video for Windows）。在AVI文件中，运动图像和伴音数据是以交织的方式存储，并独立于硬件设备。这种按交替方式组织音频和视像数据的方式可使得读取视频数据流时能更有效地从存储媒介得到连续的信息。
   - **格式特点与局限性**：AVI的文件结构分为头部，主体和索引三部分，主体中图像数据和声音数据是交互存放的，从尾部的索引可以索引跳到自己想放的位置。AVI中图像和声音是分开的，所以播放时需要一个图像和声音的同步过程，AVI本身只是提供了这么一个框架，内部的图像数据和声音数据格式可以是任意的编码形式。但是由于索引放在了文件尾部，所以在播放internet流媒体时已属力不从心。AVI格式具有兼容性好、跨平台支持、恒定帧率等特点，但也存在体积大、容错性差、不是流媒体等缺点，并且已经有些过时。
4. MOV
   - **苹果公司的格式**：MOV是Apple公司开发的QuickTime影片格式，用于存储常用数字媒体类型，如音频和视频。它是一种流式视频封装，文件是以轨道的形式组织起来的，一个MOV格式文件结构中可以包含多个轨道。例如在苹果的Final Cut Pro等视频编辑软件中，MOV格式是比较常用的输出格式。
   - **适合苹果生态**：MOV格式与苹果的系统和软件具有较好的兼容性，更适合苹果系统的使用和播放，在Final Cut Pro X中是最稳定的一种剪辑格式。由于Apple公司的影响力，MOV格式在视频制作、后期处理等领域也有一定的应用，但在其他非苹果设备和平台上的支持相对有限。
5. TS（Transport Stream）
   - **广播和流媒体常用格式**：TS流封装是随着MPEG2的流行而占据了主流的地位，全称则是Transport Stream。TS格式的特点就是要求从视频流的任一片段开始都是可以独立解码的，这使得它非常适合用于广播电视等需要随时开始播放的场景。例如数字电视广播中，TS格式可以确保观众在打开电视的任何时刻都能迅速解码并观看节目。
   - **广泛的编码支持**：用TS流封装可以无损的支持所有全部HDDVD和BD所带的视频和音频编码，包括Videocodecs（如MPEG - 2、MPEG - 4AVC、SMPTE VC - 1等）和Audiocodecs（如Linear PCM、Dolby Digital、Dolby Digital Plus、Dolby TrueHD、DTS Digital Surround、DTS - HD等）。
6. WMV
   - **微软的网络视频格式**：WMV是微软推出的一种采用独立编码的视频封装格式，它是在“同门”ASF格式的基础上升级延伸而来。在同等视频质量下，WMV格式的体积非常小，因此很适合在网上播放和传输。例如在早期的Windows Media Player上，WMV格式的视频可以流畅播放，并且在一些基于微软技术的网络视频服务中也被广泛应用。
   - **局限性与应用场景**：WMV格式的主要缺点是需要安装Windows Media Player才能播放，这在一定程度上限制了它的传播和使用范围。随着其他更通用的视频格式的兴起，现在很多视频网站，包括直播平台已经不再使用这种格式了。不过在一些企业内部的视频管理系统或者基于微软平台的特定应用场景下，WMV格式仍然可能会被使用。
7. FLV（Flash Video）
   - **网络视频的流行格式**：FLV是FLASH VIDEO的简称，是随着Flash MX的推出发展而来的视频格式。FLV的特点是体积小、支持在线播放，曾经在流媒体领域非常流行。例如在早期的视频网站如优酷、土豆等，大量的视频内容采用FLV格式进行存储和播放，这得益于Flash技术在当时的广泛应用，使得FLV格式能够在网页上快速加载和播放。
   - **随着技术发展的衰落**：随着HTML5技术的兴起，Flash技术逐渐被淘汰，FLV格式也不再像以前那样流行。但在一些特定的遗留系统或者一些对视频体积要求较小且对兼容性要求不高的场景下，FLV格式可能仍然会被使用。
8. 3GP
   - **移动设备的简化格式**：3GP是MP4（MPEG - 4Part14）格式的一种简化版本，主要用于3G手机上。它减少了储存空间和较低的频宽需求，让手机上有限的储存空间可以使用，可以封装多种多条编码的视频和音频，也可以封装字幕，但没有流媒体功能，可以做成分片式进行流式播放。例如在早期功能手机上，3GP格式是比较常见的视频格式，能够满足手机用户观看视频的基本需求。
   - **目前的应用情况**：随着手机技术的不断发展，手机性能和网络带宽都有了很大的提升，3GP格式逐渐被其他更先进的视频格式所替代，但在一些低端手机或者对视频质量和功能要求不高的移动设备上，仍然可能会看到3GP格式的视频。

# 三、视频编码方式和封装格式的区别

1. 本质含义
   - **编码方式**：视频编码格式是视频的内核，是为了压缩视频数据而做的一种压缩算法，它可以理解为不同压缩算法和方法的名称。如果有某个视频编码格式的文件，这个文件就是纯视频流数据。例如H.264编码就是一种采用特定算法对视频数据进行压缩的方式，它专注于减少视频数据量以便于存储和传输，其目的在于去除视频中的冗余信息，如人眼难以察觉的细节等，从而在保证一定视频质量的前提下减小文件大小。
   - **封装格式**：视频封装格式是视频的外壳，也叫做容器，它是将已经编码压缩好的视频流、音频流以及字幕按照一定的方式放到一个文件中，方便播放软件播放。一般来说，视频文件的后缀名就是它的封装格式。比如MKV格式，它就像一个盒子，可以把不同编码的视频、音频和字幕等内容装在一起，形成一个完整的视频文件，用户在播放时看到的是包含视频、音频和字幕等多种元素的整体内容，而不仅仅是视频流本身。
2. 数据内容
   - **编码方式**：只涉及到视频数据本身的压缩处理，主要针对的是视频图像的像素信息等进行算法处理。例如在H.265编码过程中，会对视频帧进行预测、变换、量化、熵编码等操作，这些操作都是围绕着如何将原始视频帧中的数据进行高效压缩，而不涉及音频数据和字幕等其他元素。
   - **封装格式**：需要处理多种类型的数据组合。除了包含编码后的视频流外，还会包含音频流以及可能存在的字幕信息等。例如在MP4封装格式中，它可以把采用H.264编码的视频流、AAC编码的音频流以及外挂字幕等内容整合到一起，形成一个完整的可播放的视频文件。
3. 功能侧重
   - **编码方式**：侧重于数据的压缩效率、视频质量的保证以及适应不同的网络带宽等方面。像VP9编码，其开发重点在于提高压缩效率，在保证高清甚至超高清视频质量的同时，能够在有限的网络带宽下实现流畅传输，所以在一些对带宽要求较高的4K流媒体场景中表现较好。
   - **封装格式**：更注重于将不同的媒体元素（视频、音频、字幕）整合在一起的便利性、兼容性以及对不同编码格式的支持等。例如MKV格式的开放性和跨平台性较好，能够支持多种不同编码的视频和音频格式，并且在字幕处理方面有独特的优势，如支持多字幕等功能，方便不同用户的需求。

# 四、不同视频编码方式的特点

![image-20241203221346325](https://raw.githubusercontent.com/chongzicbo/images/main/picgo/image-20241203221346325.png)

### （一）H.264/AVC

#### 优点

- **高压缩比**：在相同的图像质量条件下，H.264提供的压缩比是MPEG - 2的两倍多，是MPEG - 4的1.5到2倍。例如，如果原始文件的大小为100GB，则使用MPEG - 2标准进行压缩会将其减少到4GB，压缩比为25:1，而H.264能实现更高的压缩比，这在低比特率应用中起着至关重要的作用，显著节省了用户的下载时间和数据使用费[31](https://blog.csdn.net/haima1998/article/details/101770896)。
- **兼容性好**：由于其广泛的应用和成熟的技术，几乎所有的设备和平台都支持H.264编码的视频播放，无论是电脑、手机还是各种智能电视等设备。
- **图像质量较好**：不仅提供了高压缩比，还能提供高质量、平滑的图像，使得用H.264压缩的视频数据在网络传输过程中需要更少的带宽，更加经济。

#### 缺点

- **相对较旧**：随着技术的发展，在一些新的应用场景（如超高清视频、极低带宽等）下，H.264的性能可能不如一些新的编码标准。
- **不是最高质量编解码器**：虽然图像质量较好，但在一些对画质要求极高的专业应用场景下，还有更优的编码方式。
- **可能需要更多带宽**：在某些情况下，与一些新的高压缩效率编码相比，H.264可能需要更多的带宽来传输相同质量的视频。

### （二）VP9

#### 优点

- **高质量压缩**：能够提供比H.264更高质量的压缩效果，适用于4K等高分辨率视频的流媒体传输，在保证视频质量的同时，能够有效地降低传输所需的带宽。
- **兼容性较好**：得到了许多设备和平台的支持，尤其是在一些支持Google技术的生态系统中，具有较好的兼容性。

#### 缺点

- **相对小众**：虽然具有较好的性能，但在市场份额上相对H.264等编码方式较小，可能在一些不支持VP9的设备上无法正常播放。
- **技术受限于Google**：作为Google开发的编码技术，其发展和应用在一定程度上受Google的战略和技术决策影响。

### （三）AV1

#### 优点

- **高效编码效率**：目标是在VP9/HEVC基础上提高约30%的编码效率，在同等的PSNA和VMAF质量下，AV1比HEVC有36.58%的码率节省，可以用更少的码率实现相同的视频质量，尤其适合网络视频传输，能够节省网络带宽[20](https://blog.csdn.net/mabeijianxi/article/details/72933910)。
- **免费开源**：完全免费，没有专利费用的困扰，无论是商业用途还是非商业用途都可以自由使用，这对于内容创作者和开发者来说具有很大的吸引力，尤其是那些希望避免高昂专利费用的项目。
- **适合低计算能力硬件**：能够在具有低计算能力的硬件上运行，这使得它可以应用于更多的设备，包括一些低端的智能手机、智能电视等设备，扩大了其应用范围。

#### 缺点

- **编码速度慢**：目前AV1的编码时间非常长，例如在48核HPZ840工作站上进行5秒钟的TearsofSteel1080p源素材编码需要23小时46分钟（1,426分钟），相比之下，其他编码方式如x265、VP9、H.264的编码时间要短很多。这使得在一些需要实时编码或者快速转码的场景下，AV1的应用受到限制[20](https://blog.csdn.net/mabeijianxi/article/details/72933910)。
- **硬件支持有限**：虽然越来越多的设备开始支持AV1，但仍然有很多旧设备无法支持AV1编码，这可能会影响到视频的播放效果和质量，限制了其在一些场景下的普及。

### （四）MPEG系列

### （1）MPEG - 1

优点

- **早期的标准**：是较早的视频编码标准，在当时解决了视频存储和传输的一些基本问题，为后续的视频编码技术发展奠定了基础。
- **简单易用**：由于其技术相对简单，在一些对视频质量要求不高、存储空间和传输带宽有限的早期应用场景（如VCD）中得到了广泛的应用。

缺点

- **低质量**：按照现在的标准来看，MPEG - 1的视频质量较差，分辨率和帧率都比较低，无法满足现代高清视频的需求。
- **低压缩效率**：与现代的视频编码标准相比，MPEG - 1的压缩效率较低，需要更多的存储空间和传输带宽来存储和传输视频。

### （2）MPEG - 2

#### 优点

- **高质量**：质量远远好于MPEG - 1，能够满足DVD - Video和高清电视（HDTV）的要求，提供了较高的分辨率（如1920x1080）和较好的图像质量。
- **广泛应用**：作为DVD - Video唯一指定的视频编码，以及在HDTV中的广泛应用，使得MPEG - 2具有很好的兼容性，几乎所有的DVD播放器和大多数高清电视都支持MPEG - 2编码的视频播放。

#### 缺点

- **高要求**：对播放硬件要求相对较高，在一些低端设备上可能无法流畅播放。
- **压缩效率相对较低**：与一些新的视频编码标准相比，在相同的视频质量下，MPEG - 2可能需要更多的存储空间和传输带宽。

### （3）MPEG - 4

#### 优点

- **高压缩效率**：算法较MPEG - 1、MPEG - 2更为优化，在压缩效率上更高，能够以最少的数据获得最佳的图像质量，在网络传输方面效果较好。
- **适应多种场景**：主要应用在互联网、数字电视、实时多媒体监控、动态图像、移动多媒体通信、DVD上的交互多媒体应用、Internet/intranet上的视频流与可视游戏等多种方面，具有很强的适应性。
- **可实现DVD质量**：对于普通用户来说，最有吸引力的地方在于它能在普通CD - ROM上实现DVD的质量。

#### 缺点

- **对硬件要求高**：对播放硬件要求较高，在一些性能较低的设备上可能无法正常播放或者播放效果不佳。

# 五、不同视频编码方式的应用场景

## （一）H.264/AVC

- **互联网视频传输**：由于其高压缩比、较好的图像质量和广泛的兼容性，非常适合在互联网上进行视频传输，如在线视频平台（优酷、腾讯视频等）的大部分视频都是采用H.264编码。
- **移动设备视频播放**：在手机、平板电脑等移动设备上，H.264得到了广泛的支持，无论是本地播放还是在线播放，都能够很好地适应移动设备的硬件性能和网络环境。
- **监控视频系统**：在监控领域，H.264可以有效地减少视频存储空间，同时保证监控视频的质量，方便长时间的视频存储和远程查看。

## （二）VP9

- **4K流媒体**：其高质量的压缩效果使其特别适合4K等高分辨率视频的流媒体传输，如一些提供4K视频服务的平台可能会采用VP9编码来降低传输带宽需求。
- **Google生态系统内应用**：在Google的生态系统中，如YouTube等平台，VP9编码得到了较好的应用，因为Google可以更好地控制和优化其在自己平台上的应用。

## （三）AV1

- **互联网视频的未来趋势**：由于其免费开源、高效的编码效率和对低计算能力硬件的适应性，AV1被视为未来互联网视频编码的一个重要发展方向，尤其是对于那些需要大量节省带宽成本的在线视频平台和内容提供商。
- **用户生成内容（UGC）平台**：对于一些用户生成内容的平台，如抖音、B站等，AV1的免费特性可以吸引更多的创作者上传高质量的视频内容，同时在保证视频质量的前提下，降低平台的存储和传输成本。

## （四）MPEG系列

### （1）MPEG - 1

- **VCD存储和播放**：主要应用于VCD（Video CD）的存储和播放，在早期的CD - ROM视频存储中发挥了重要作用，是当时家庭视频娱乐的主要格式之一。

### （2）MPEG - 2

- **DVD - Video和HDTV**：是DVD - Video唯一指定的视频编码，同时在高清电视（HDTV）领域也有广泛的应用，用于视频的制作、存储和播放。

### （3）MPEG - 4

- **网络多媒体应用**：广泛应用于互联网、数字电视、实时多媒体监控、动态图像、移动多媒体通信、DVD上的交互多媒体应用、Internet/intranet上的视频流与可视游戏等方面，是一种多功能的视频编码方式，尤其适合在网络环境下的多媒体应用。

# 六、如何选择适合的视频编码方式

## （一）考虑视频的应用场景

- **在线视频平台**：如果是为在线视频平台提供视频内容，需要考虑平台的要求和用户的设备兼容性。目前H.264仍然是最广泛支持的编码方式，但随着技术的发展，AV1等新兴编码方式可能会逐渐普及。例如，一些追求节省带宽成本的新兴在线视频平台可能会开始支持AV1编码。
- **移动设备视频**：对于移动设备上的视频应用，要考虑移动设备的性能和电池消耗。H.264在移动设备上的兼容性非常好，但如果设备性能允许，一些新的编码方式如VP9或AV1可能会提供更好的视频质量和更低的带宽消耗。例如，高端智能手机可以支持VP9编码的4K视频播放，并且相比H.264可以节省更多的流量。
- **监控系统**：在监控系统中，需要长期存储大量的视频数据，因此编码方式的压缩效率非常重要。H.264是目前监控系统中广泛使用的编码方式，不过一些新的编码方式如果能够提供更高的压缩效率并且保持较好的图像质量，也可以考虑用于监控系统的升级。

## （二）考虑视频的质量要求

- **高画质要求**：如果对视频的画质要求非常高，如电影制作、专业的视频编辑等领域，可能需要考虑采用一些新的编码方式，如H.265（HEVC）或者AV1。这些编码方式在相同的码率下能够提供更高的图像质量，或者在相同的图像质量下可以使用更低的码率。不过需要注意的是，这些编码方式可能对硬件设备和播放平台有更高的要求。